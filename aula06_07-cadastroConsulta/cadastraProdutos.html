<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="./styles/cadastra.css">
  <title>Consulta Vendas</title>
</head>

<body>
  <header>
    <h1>Cadastrar Produtos</h1>

  </header>

  <main>
    <div class="inputItem">
      <label for="categoria">Categoria:</label>
      <input type="text" id="categoria" placeholder="Ex: placa de vÃ­deo" title="Digite a categoria">
    </div>
    <div class="inputItem">
      <label for="modelo">Modelo:</label>
      <input type="text" id="modelo" placeholder="Ex: RTX 3080 ti" title="Digite o modelo">
    </div>
    <div class="inputItem">
      <label for="fabricante">Fabricante:</label>
      <input type="text" id="fabricante" placeholder="Ex: ASUS" title="Digite o fabricante">
    </div>

    <button onclick="gravar(categoria, modelo, fabricante)">Gravar</button>
  </main>

  <script>
    function display(obj) {
      let linha = "<tr>"
      for (let prop in obj) {
        linha += `<td>${obj[prop]}</td>`
      }
      linha += "</tr>"
      // console.log(linha);
      return linha
    }

    function gravar(categoria, modelo, fabricante) {

      if (!categoria.value) {
        alert("Digite a categoria")
        categoria.focus()
        return
      } else if (!modelo.value) {
        alert("Digite o modelo")
        modelo.focus()
        return
      } else if (!fabricante.value) {
        alert("Digite o fabricante")
        fabricante.focus()
        return
      }

      const objeto = {
        categoria: categoria.value,
        modelo: modelo.value,
        fabricante: fabricante.value
      }

      console.log(objeto);

      fetch("http://localhost:3000/produtos", {
        method: "POST",
        body: JSON.stringify(objeto),
        headers: {
          "Content-type": "application/json; charset=UTF-8"
        }
      })
      parent.document.getElementsByTagName("iframe")[0].src = "cadastraProdutos.html"
    }
  </script>
</body>

</html>